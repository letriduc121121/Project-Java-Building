<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Login</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/register/vendor/bootstrap/css/bootstrap.min.css}"/>
    <link rel="stylesheet" th:href="@{/register/css/small-business.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/register/register.css}"/>
</head>
<body>
<div class="container">
    <div class="row justify-content-center">
        <div class="register-container">
            <div class="register-card">
                <!-- Header -->
                <div class="register-header">
                    <h2><img th:src="@{/img/login-user.png}" alt="login icon" class="header-icon">Login</h2>
                    <p>Please enter your information</p>
                </div>

                <div class="register-body">
                    <!-- Access Denied -->
                    <div class="alert alert-danger" th:if="${param.accessDenied}">
                        <i class="fas fa-ban me-2"></i>
                        You are not authorized
                    </div>

                    <div th:if="${param.incorrectAccount}" class="alert alert-danger">
                        <i class="fas fa-ban me-2"></i>
                        Username or password incorrect
                    </div>
                    <!-- Session Timeout -->
                    <div class="alert alert-danger" th:if="${param.sessionTimeout}">
                        <i class="fas fa-clock me-2"></i>
                        Session timeout
                    </div>

                    <!-- Form -->
                    <form id="loginForm" th:action="@{/j_spring_security_check}" method="post">
                        <!-- Username -->
                        <div class="form-group">
                            <label class="form-label" for="userName">
                                <i class="fas fa-at me-1"></i>Username
                            </label>
                            <input type="text" name="userName" class="form-control" id="userName"
                                   placeholder="Choose a username" required>
                        </div>

                        <!-- Password -->
                        <div class="form-group">
                            <label class="form-label" for="password">
                                <i class="fas fa-lock me-1"></i>Password
                            </label>
                            <div class="password-field">
                                <input type="password" id="password" name="password" class="form-control" required>
                                <button type="button" class="password-toggle" onclick="togglePassword('password')">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                        </div>
                        <!-- Submit -->
                        <button type="submit" class="btn btn-dark w-100 mt-3" id="loginButton">
                            LOG IN
                        </button>

                        <a class="btn btn-dark w-100 mt-3" th:href="@{/}">HOME<span
                                class="sr-only">(current)</span>
                        </a>
                    </form>

                    <!-- Social Login -->
                    <div class="social-login">
                        <div class="social-title">Or login with</div>
                        <div class="social-buttons">
                            <a href="#" class="social-btn" title="Register with Facebook">
                                <i class="fab fa-facebook-f"></i>
                            </a>
                            <a href="#" class="social-btn" title="Register with Google">
                                <i class="fab fa-google"></i>
                            </a>
                            <a href="#" class="social-btn" title="Register with Twitter">
                                <i class="fab fa-twitter"></i>
                            </a>
                        </div>
                    </div>
                    <div class="login-link">
                        Don't have an account?
                        <a th:href="@{/register}">Sign Up</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- ------------------------------Login page end---------------------------------- -->
<th:block th:replace="~{admin/common/common-scripts :: jquery}"></th:block>
<script>
    function togglePassword(fieldId) {
        const field = document.getElementById(fieldId);
        const toggle = field.nextElementSibling;
        const icon = toggle.querySelector('i');

        if (field.type === 'password') {
            field.type = 'text';
            icon.classList.remove('fa-eye');
            icon.classList.add('fa-eye-slash');
        } else {
            field.type = 'password';
            icon.classList.remove('fa-eye-slash');
            icon.classList.add('fa-eye');
        }
    }

    // Login form validation
    document.getElementById('loginForm').addEventListener('submit', function (e) {
        const username = document.getElementById('username').value.trim();
        const password = document.getElementById('password').value;

        if (username.length < 3) {
            alert('Username must contain at least 3 characters!');
            e.preventDefault();
            return false;
        }

        if (password.length < 3) {
            alert('Password must contain at least 3 characters!');
            e.preventDefault();
            return false;
        }

        // Optional loading effect
        const btn = document.getElementById('loginButton');
        btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Logging in...';
        btn.disabled = true;

        return true; // allow submit
    });
</script>
</body>
</html>